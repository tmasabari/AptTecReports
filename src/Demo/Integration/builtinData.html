<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Simple Table Demo 1</title>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
        crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        .previewParent > div {
            float: left;
        }
    </style>
</head>

<body>
    <table style="border-collapse:collapse;width: 100%;">
        <tbody>
            <tr>
                <td style="width: 20%;text-align:left;">
                </td>
                <td style="width: 60%; text-align: center;">
                    <strong>
                        <h1><a href="https://apttec.com">AptTec Reports</a></h1>
                        <h6>Built-in Json Data Integration Demo 1</h6>
                        <br>
                    </strong>
                </td>
                <td class="previewParent" style="text-align:right;">
                    <div class="jobqueue"></div>
                    <div class="letter"></div>
                    <div class="dailyTotals"></div>
                </td>
            </tr>
        </tbody>
    </table>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"
        integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g="
        crossorigin="anonymous"></script>
    <!-- load bootstrap only after jquery -->
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>  

    <script src="/Resources/Scripts/Integration/AptTecIntegration.js" type="module"
        crossorigin="anonymous">
        </script>
    <script>
        const baseLocation = '/';
        var aptTecintegration;
        //listen/register this handler first before any other body part loads
        document.addEventListener('DOMContentLoaded', () =>
        {
            //this executes after all modules/deferred scripts are loaded
            aptTecintegration = new window.AptTecReporting.Integration(baseLocation, 'builtinLocalDataFrame', baseLocation + 'Data/Templates/');

            const localJobQueueButtonResult = aptTecintegration.addPreviewButton(
                'jobqueuereport', '.previewParent .jobqueue', null, null, 'btn btn-success', 'fa fa-print', 'Job Queue', 'start');

            const localLetterButtonResult = aptTecintegration.addPreviewButton('letter',
                '.previewParent .letter', null,
                () => fetch(baseLocation + 'Data/Samples/coverletter.json').then(response => response.json())
                //aptTecintegration.fetchData(, 'CommonData', 'CommonData')
                , 'btn btn-success', 'fa fa-print', 'Letter', 'end'); 

            const dailyTotalsButtonResult = aptTecintegration.addPreviewButton('dailyTotals',
                '.previewParent .dailyTotals', null,
                () => fetch(baseLocation + 'Data/Samples/dailyTotalData.json')
                        .then(response => response.json())
                        .then(jsonObject => {
                            // do you custom logic here and populate the listDailyTotals
                            aptTecintegration.aptTecData.CommonData = {
                                "OrgAddress1": 'Your Client Address Line 1',
                                "OrgAddress2": 'Your Client Address Line 2',
                                "OrgAddress3": 'Your Client Address Line 3',
                                "ClientTitle": 'Your Client Title'
                            };
                            aptTecintegration.aptTecData.InstanceData = {
                                "ReportStartDate": '01/01/2023',
                                "ReportEndDate": '01/01/2023' 
                            };
                            jsonObject.listDailyTotals.forEach(element => {
                                element.orderDate = new Date(element.orderDate);
                            });
                            aptTecintegration.aptTecData.Data = jsonObject.listDailyTotals;
                            return aptTecintegration.aptTecData;

                        })
                //aptTecintegration.fetchData(, 'CommonData', 'CommonData')
                , 'btn btn-success', 'fa fa-print', 'Daily Totals', 'end'); 
        });
    </script>
</body>

</html>