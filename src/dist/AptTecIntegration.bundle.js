(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{autoDownloadUrl:()=>l,createAssignElement:()=>o,createButton:()=>a,createButtonAtParent:()=>s,createControl:()=>i,createUrlFromJsonString:()=>d,createUrlFromObject:()=>c,loadScript:()=>u,loadStylesheet:()=>h});var r={};e.r(r),e.d(r,{firstNCharacters:()=>w,getKendoSortedData:()=>g,mergeExistingProperties:()=>p});var n={};function o(e,t=void 0){const r=globalThis.document.createElement(e);return t?Object.assign(r,t):r}function i(e,t,r,n){const i=o(e);return t&&(i.className=t),r&&(i.innerHTML=`<i class="${r}"></i>`),n&&(i.innerHTML+=` ${n}`),i}function a(e,t,r,n){const o=i("button",e,t,r);return o.addEventListener("click",n),o}function s(e,t,r,n,o,i="start",a={},s="",d=!0){var c=globalThis.document.querySelector(t);if(!c)throw"Could not add a button. Please check buttonParent selector";const l=t+" #"+e;if(d){const e=globalThis.document.querySelector(l);if(e)return{ButtonObject:e,AlreadyExists:!0}}var h=` id='${e}' ${s} `;if(a["parent-selector"]=t,a)for(const[e,t]of Object.entries(a))h+=` data-${e}='${t}'`;const u=`<button ${h}  class='${r}' type='button' >\n                <i class='${n}'></i>${o}</button>`;return"start"===i?c.innerHTML=u+c.innerHTML:c.innerHTML+=u,{ButtonObject:globalThis.document.querySelector(l),AlreadyExists:!1}}function d(e){const t=new Blob([e],{type:"application/json"});return URL.createObjectURL(t)}function c(e){return d(JSON.stringify(e,null,2))}function l(e,t="data.json"){o("a",{href:e,download:t}).click()}function h(e){var t=o("link",{href:e,rel:"stylesheet"});globalThis.document.head.appendChild(t)}function u(e,t=void 0,r=void 0,n=void 0){var i=o("script",{src:e,type:"text/javascript",async:n,defer:r,onload:t});globalThis.document.head.appendChild(i)}function p(e,t){let r=JSON.parse(JSON.stringify(e));for(const e in t)Object.prototype.hasOwnProperty.call(r,e)&&(r[e]=t[e]);return r}function w(e,t,r){return e.forEach((e=>{e[t]&&e[t].length>r&&(e[t]=e[t].substring(0,r))})),e}function g(e){var t=globalThis.document.querySelector(e);if(!t)return null;var r=t.data("kendoGrid");if(!r)return null;var n=r.dataSource,o=n.data(),i=n.sort();return o.length>0&&i?new window.kendo.data.Query(o).sort(i).data:o}function m(){const e=document.createElement("div");e.style.width="1in",document.body.appendChild(e);const t=e.offsetWidth;return document.body.removeChild(e),t}e.r(n),e.d(n,{getDeviceDPI:()=>m}),globalThis.AptTec=globalThis.AptTec||{},globalThis.AptTec.Downloader=class{constructor(e,t=1048576,r=9,n=3e3,o=10){this.url=e,this.minFileSize=t,this.splits=o,this.maxRetries=r,this.retryDelay=n,this.chunkCompleted=new Event("chunkCompleted"),this.chunkSize=-1,this.fileLength=-1}async download(){try{const{supportsChunked:e,fileLength:t}=await this.#e();if(this.fileLength=t,e&&t>=this.minFileSize){this.chunkSize=Math.ceil(t/this.splits);const e=await this.#t();return console.log("Chunked download completed."),e}{const e=await this.downloadSimple();return console.log("Simple download completed."),e}}catch(e){throw console.error("An error occurred:",e),e}}async downloadSimple(){const e=await this.#r(-1,-1);return new Blob([e])}async#e(){try{const e=await fetch(this.url,{method:"HEAD"});return{supportsChunked:"bytes"===e.headers.get("accept-ranges"),fileLength:parseInt(e.headers.get("content-length"))}}catch(e){return console.error("Error checking chunked support:",e),{supportsChunked:!1,fileLength:0}}}async#t(){const e=[];let t=0;var r=0;const n=[],o=this.fileLength;for(;t<o;){const i=Math.min(t+this.chunkSize-1,o-1);(()=>{const a=t,s=i,d=this.#r(a,s).then((t=>{e.push({start:a,chunk:t});const n=(r+=s-a+1)/o*100;this.chunkCompleted.detail={downloadedSize:r,totalSize:o,progress:n},document.dispatchEvent(this.chunkCompleted)})).catch((e=>this.#n(e,a,s)));n.push(d)})(),t=i+1}return await Promise.all(n),e.sort(((e,t)=>e.start-t.start)),new Blob(e.map((e=>e.chunk)))}async#r(e,t){const r=e<0?await fetch(this.url):await fetch(this.url,{headers:{Range:`bytes=${e}-${t}`}});if(!r.ok)throw new Error(`Chunk download failed with status code: ${r.status}`);return await r.arrayBuffer()}async#n(e,t,r){if(console.error("Chunk download error:",e),this.maxRetries>0)return await new Promise((e=>setTimeout(e,this.retryDelay))),console.log("Retrying chunk download..."),this.maxRetries--,this.#n(await this.#r(t,r),t,r);throw e}},globalThis.AptTec.DynamicControls=t,globalThis.AptTec.Json=r,globalThis.AptTec.Graphics=n,window.AptTecReporting=window.AptTecReporting||{},window.AptTecReporting.Kendo={},window.AptTecReporting.Kendo.getSortedData=g,window.AptTecReporting.Integration=class{#o="Pages/designer.html";#i="{{SourceUrl}}";#a="\n                position: absolute;\n                height: calc(100vh - 120px);\n                border: 1px solid black;\n                margin-left: -1px;\n                margin-top: -1px;\n                z-index: 1000;\n                width: 99%;\n                top: 92px;\n                display:none;\n                ";#s=".AptTecPrintPreview";#d=null;#c=!1;#l="";#h="";#u="";constructor(e,t,r,n,o=!1){this.aptTecData={CommonData:{},InstanceData:{},Data:[]},this.designerWindow=null,this.isPreviewTypeDesigner=o,this.#l=e.endsWith("/")?e:e+"/",this.#h=t,this.#p(n),this.#d=document.getElementById(this.#h),this.#u=r,this.#w()}#p(e){const t=e||this.#a,r=`\n        <style>\n            #${this.#h} { ${t} } \n        </style>\n        <iframe id="${this.#h}"></iframe>`;$("body").append(r)}#w(){const e=this.#l+this.#o;fetch(e).then((e=>e.text())).then((e=>{var t=e.replace(new RegExp(this.#i,"ig"),this.#l);this.#d.srcdoc=t,this.#d.onload=()=>{this.#g()}})).catch((e=>{console.error("Error loading the preview designer:",e)}))}#g(){this.#c=!0,$(this.#s).prop("disabled",!1),this.designerWindow=document.getElementById(this.#h).contentWindow,this.designerWindow.initilizePreview({templatesLocation:this.#u,sourceUrl:this.#l,closeAction:()=>$("#"+this.#h).hide()}),this.designerWindow.aptTecReports.showHideDesigner(this.isPreviewTypeDesigner)}get aptTecReports(){return this.designerWindow.aptTecReports}addPreviewButton(e,t,r={},n=null,o="btn btn-success",i="fa fa-print",a="",s="start",d=null){var c=this.#m(d,e,t,r,o,i,a,s);if(!c.AlreadyExists)return this.#f(c,n),c}#m(e,t,r,n,o,i,a,d){e||(e=t.replace(/[^a-zA-Z]/g,"")+"PreviewButton"),n||(n={}),n["render-target"]=this.#h,n["report-id"]=t;const c=s(e,r,o+=" AptTecPrintPreview",i,a,d,n,this.#c?"":"disabled");return{previewButton:c.ButtonObject,AlreadyExists:c.AlreadyExists}}#f(e,t){const r=this;e.previewButton.addEventListener("click",(()=>{if("function"==typeof t)r.designerWindow.aptTecReports.dataGetter=t;else switch(t){case"direct":r.designerWindow.aptTecReports.dataGetter=()=>(r.aptTecData.Data=e.previewButton.printData,r.aptTecData);break;case"kendoGrid":r.designerWindow.aptTecReports.dataGetter=()=>(r.aptTecData.Data=g(e.previewButton.dataset.gridId),r.aptTecData);break;default:r.designerWindow.aptTecReports.dataGetter=null}r.showPreview(e.previewButton.dataset.reportId)}))}showPreview(e){this.designerWindow.aptTecReports.reportId=e,$("#"+this.#h).show(),this.designerWindow.aptTecReports.refreshReport()}fetchData(e,t,r){const n=this;return new Promise((function(o,i){fetch(e).then((e=>e.json())).then((e=>{n.aptTecData[t]=r?e[r]:e,o(n.aptTecData)})).catch((e=>{console.error("Error loading report parameters:",e),i()}))}))}print(){this.designerWindow.document.getElementById("reportIframe").contentWindow.print()}getPageCount(){return this.designerWindow.aptTecReports.PagesCount}}})();
//# sourceMappingURL=AptTecIntegration.bundle.js.map