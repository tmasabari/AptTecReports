(()=>{var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}};(()=>{"use strict";var t={};e.r(t),e.d(t,{autoDownloadUrl:()=>c,createAssignElement:()=>o,createButton:()=>i,createButtonAtParent:()=>s,createControl:()=>a,createUrlFromJsonString:()=>l,createUrlFromObject:()=>d,loadScript:()=>u,loadStylesheet:()=>h});var n={};e.r(n),e.d(n,{firstNCharacters:()=>p,getKendoSortedData:()=>y,mergeExistingProperties:()=>f});var r={};function o(e,t=void 0){const n=globalThis.document.createElement(e);return t?Object.assign(n,t):n}function a(e,t,n,r){const a=o(e);return t&&(a.className=t),n&&(a.innerHTML=`<i class="${n}"></i>`),r&&(a.innerHTML+=` ${r}`),a}function i(e,t,n,r){const o=a("button",e,t,n);return o.addEventListener("click",r),o}function s(e,t,n,r,o,a="start",i={},s="",l=!0){var d=globalThis.document.querySelector(t);if(!d)throw"Could not add a button. Please check buttonParent selector";const c=t+" #"+e;if(l){const e=globalThis.document.querySelector(c);if(e)return{ButtonObject:e,AlreadyExists:!0}}var h=` id='${e}' ${s} `;if(i["parent-selector"]=t,i)for(const[e,t]of Object.entries(i))h+=` data-${e}='${t}'`;const u=`<button ${h}  class='${n}' type='button' >\n                <i class='${r}'></i>${o}</button>`;return"start"===a?d.innerHTML=u+d.innerHTML:d.innerHTML+=u,{ButtonObject:globalThis.document.querySelector(c),AlreadyExists:!1}}function l(e){const t=new Blob([e],{type:"application/json"});return URL.createObjectURL(t)}function d(e){return l(JSON.stringify(e,null,2))}function c(e,t="data.json"){o("a",{href:e,download:t}).click()}function h(e){var t=o("link",{href:e,rel:"stylesheet"});globalThis.document.head.appendChild(t)}function u(e,t=void 0,n=void 0,r=void 0){var a=o("script",{src:e,type:"text/javascript",async:r,defer:n,onload:t});globalThis.document.head.appendChild(a)}function f(e,t){let n=JSON.parse(JSON.stringify(e));for(const e in t)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=t[e]);return n}function p(e,t,n){return e.forEach((e=>{e[t]&&e[t].length>n&&(e[t]=e[t].substring(0,n))})),e}function y(e){var t=globalThis.document.querySelector(e);if(!t)return null;var n=t.data("kendoGrid");if(!n)return null;var r=n.dataSource,o=r.data(),a=r.sort();return o.length>0&&a?new window.kendo.data.Query(o).sort(a).data:o}function b(){const e=document.createElement("div");e.style.width="1in",document.body.appendChild(e);const t=e.offsetWidth;return document.body.removeChild(e),t}function g(e,t,n,r,o){const a=n.filter((function(e){return!0===e.isPrint}));var i="tblReport"+t,s='<table id="'+i+'" class="dataTable display" width="100%"></table>';o.append(s);const l=r?e.reportData.Data[r]:e.reportData.Data;a.filter((function(e){return e.maxLength&&e.maxLength>0})).forEach((e=>{p(l,e.field,e.maxLength)}));const d=n.filter((function(e){return!0===e.TotalCount})),c={info:!1,ordering:!1,paging:!1,searching:!1,data:l,columns:m(e,a)};if(d&&d.length>0){c.footerCallback=function(){let e=this.api(),t=function(e){return"string"==typeof e?1*e.replace(/[^\d.-]/g,""):"number"==typeof e?e:0};for(var n=0;n<a.length;n++)if(!0===a[n].TotalCount){let r=e.column(n).data().reduce(((e,n)=>t(e)+t(n)),0);e.column(n).footer().innerHTML=r}};const e=`<tfoot><tr> ${"<th></th> ".repeat(a.length)}</tr></tfoot>`;$("#"+i).append(e)}var h="<Style>";$("#"+i).DataTable(c);for(let e=0;e<a.length;e++){const t=a[e];var u="cssTH-"+t.field;$(`#${i} tr th:nth-child(${e+1})`).addClass(u),h+=`.${u} { ${t.TitleStyle?t.TitleStyle:""} }\n`;var f="cssTD-"+t.field;$(`#${i} tr td:nth-child(${e+1})`).addClass(f),h+=`.${f} { ${t.ContentStyle?t.ContentStyle:""} }\n`}h+="</Style>",o.append(h)}function m(e,t){t=t.map((e=>({field:"object"==typeof e?e.field:e,displayName:"object"==typeof e?e.displayName:e,columnSize:"object"==typeof e&&e.columnSize?e.columnSize:100/t.length+"%",format:"object"==typeof e&&e.format?e.format:""})));for(let n=0;n<t.length;n++){const r=t[n];if(r.data=r.field,r.title=r.displayName,r.width=r.columnSize,"object"==typeof r&&r.format){const t=r.format.toLowerCase();r.render=e.customFunctions[t]}}return t}e.r(r),e.d(r,{getDeviceDPI:()=>b}),globalThis.AptTec=globalThis.AptTec||{},globalThis.AptTec.Downloader=class{constructor(e,t=1048576,n=9,r=3e3,o=10){this.url=e,this.minFileSize=t,this.splits=o,this.maxRetries=n,this.retryDelay=r,this.chunkCompleted=new Event("chunkCompleted"),this.chunkSize=-1,this.fileLength=-1}async download(){try{const{supportsChunked:e,fileLength:t}=await this.#e();if(this.fileLength=t,e&&t>=this.minFileSize){this.chunkSize=Math.ceil(t/this.splits);const e=await this.#t();return console.log("Chunked download completed."),e}{const e=await this.downloadSimple();return console.log("Simple download completed."),e}}catch(e){throw console.error("An error occurred:",e),e}}async downloadSimple(){const e=await this.#n(-1,-1);return new Blob([e])}async#e(){try{const e=await fetch(this.url,{method:"HEAD"});return{supportsChunked:"bytes"===e.headers.get("accept-ranges"),fileLength:parseInt(e.headers.get("content-length"))}}catch(e){return console.error("Error checking chunked support:",e),{supportsChunked:!1,fileLength:0}}}async#t(){const e=[];let t=0;var n=0;const r=[],o=this.fileLength;for(;t<o;){const a=Math.min(t+this.chunkSize-1,o-1);(()=>{const i=t,s=a,l=this.#n(i,s).then((t=>{e.push({start:i,chunk:t});const r=(n+=s-i+1)/o*100;this.chunkCompleted.detail={downloadedSize:n,totalSize:o,progress:r},document.dispatchEvent(this.chunkCompleted)})).catch((e=>this.#r(e,i,s)));r.push(l)})(),t=a+1}return await Promise.all(r),e.sort(((e,t)=>e.start-t.start)),new Blob(e.map((e=>e.chunk)))}async#n(e,t){const n=e<0?await fetch(this.url):await fetch(this.url,{headers:{Range:`bytes=${e}-${t}`}});if(!n.ok)throw new Error(`Chunk download failed with status code: ${n.status}`);return await n.arrayBuffer()}async#r(e,t,n){if(console.error("Chunk download error:",e),this.maxRetries>0)return await new Promise((e=>setTimeout(e,this.retryDelay))),console.log("Retrying chunk download..."),this.maxRetries--,this.#r(await this.#n(t,n),t,n);throw e}},globalThis.AptTec.DynamicControls=t,globalThis.AptTec.Json=n,globalThis.AptTec.Graphics=r;var w=window.parent.aptTecReports;window.onload=function(){$.fn.dataTable.ext.errMode="none",$(".content .dataTable").on("error.dt",(function(e,t,n,r){console.error("An error has been reported by DataTables: ",r)}));const e=$(".content");var t=1;if(w.ReportParams.Content)for(let r=0;r<w.ReportParams.Content.length;r++){const o=w.ReportParams.Content[r];if(Object.prototype.hasOwnProperty.call(o,"ContentHtml")){var n=w.replacePlaceholders(o.ContentHtml,w.reportData.CommonData);n=w.replacePlaceholders(n,w.reportData.InstanceData),e.append(n)}else if(Object.prototype.hasOwnProperty.call(o,"TableContent")&&Array.isArray(o.TableContent)){const n=o.DataSource;g(w,t,o.TableContent,n,e),t++}}window.PagedPolyfill.preview()}})(),(()=>{class e extends window.Paged.Handler{constructor(e,t,n){super(e,t,n)}beforeParsed(e){window.parent.aptTecReports.raiseEvent("beforePreviewParsed",e)}afterRendered(e){window.parent.aptTecReports.raiseEvent("afterPreviewRendered",e)}}window.Paged.registerHandlers(e)})(),(()=>{class e extends Paged.Handler{constructor(e,t,n){super(e,t,n),this.splitTablesRefs=[]}afterPageLayout(e,t,n,r){if(this.chunker=r,this.splitTablesRefs=[],n){const t=n.node,o=this.findAllAncestors(t,"table");if("TABLE"===t.tagName&&o.push(t),o.length>0){this.splitTablesRefs=o.map((e=>e.dataset.ref));let a="THEAD"===t.tagName?t:this.findFirstAncestor(t,"thead");if(a){let e=a.hasChildNodes()?a.lastChild:a;n.node=this.nodeAfter(e,r.source)}this.hideEmptyTables(e,t)}}}hideEmptyTables(e,t){this.splitTablesRefs.forEach((n=>{let r=e.querySelector("[data-ref='"+n+"']");if(r){let e=r.querySelector("tbody > tr");if(!e||this.refEquals(e.firstElementChild,t)){r.style.visibility="hidden",r.style.position="absolute";let e=r.nextSibling;e&&(e.style.visibility="hidden",e.style.position="absolute")}}}))}refEquals(e,t){return e&&e.dataset&&t&&t.dataset&&e.dataset.ref===t.dataset.ref}findFirstAncestor(e,t){for(;e.parentNode&&1===e.parentNode.nodeType;){if(e.parentNode.matches(t))return e.parentNode;e=e.parentNode}return null}findAllAncestors(e,t){const n=[];for(;e.parentNode&&1===e.parentNode.nodeType;)e.parentNode.matches(t)&&n.unshift(e.parentNode),e=e.parentNode;return n}layout(e,t){this.splitTablesRefs.forEach((t=>{const n=e.querySelector("[data-ref='"+t+"']");if(n&&!n.getAttribute("repeated-headers")){const e=this.chunker.source.querySelector("[data-ref='"+t+"']");this.repeatColgroup(e,n),this.repeatTHead(e,n),n.setAttribute("repeated-headers",!0)}}))}repeatColgroup(e,t){let n=e.querySelectorAll("colgroup"),r=t.firstChild;n.forEach((e=>{let n=e.cloneNode(!0);t.insertBefore(n,r)}))}repeatTHead(e,t){let n=e.querySelector("thead");if(n){let e=n.cloneNode(!0);t.insertBefore(e,t.firstChild)}}nodeAfter(e,t){if(t&&e===t)return;let n=this.nextSignificantNode(e);if(n)return n;if(e.parentNode)for(;e=e.parentNode;){if(t&&e===t)return;if(n=this.nextSignificantNode(e),n)return n}}nextSignificantNode(e){for(;e=e.nextSibling;)if(!this.isIgnorable(e))return e;return null}isIgnorable(e){return 8===e.nodeType||3===e.nodeType&&this.isAllWhitespace(e)}isAllWhitespace(e){return!/[^\t\n\r ]/.test(e.textContent)}}Paged.registerHandlers(e)})()})();
//# sourceMappingURL=previewContent.bundle.js.map